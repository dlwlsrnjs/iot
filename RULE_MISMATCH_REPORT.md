# RAG 문서 규칙 vs 실제 데이터 불일치 보고서

## 문제 발견

가이드의 분류 규칙과 실제 데이터가 **매우 잘 맞지 않습니다**. 이것이 정확도가 낮은 주요 원인입니다.

## 상세 분석 결과

### 1. Arp_Spoofing 규칙 불일치

**가이드 규칙**:
- Fwd Header Size Max > 1.5
- Bwd Header Size Max > 2.0
- Flow Pkts Per Sec > 0.3

**실제 데이터**:
- Fwd Header Size Max > 1.5: **57.4%만 만족** ⚠️
- Bwd Header Size Max > 2.0: **61.5%만 만족** ⚠️
- Flow Pkts Per Sec > 0.3: **41.4%만 만족** ⚠️
- **모든 규칙 동시 만족: 20.8%만 만족** ❌

**실제 데이터 통계**:
- Fwd Header Size Max 평균: 1.9698, 중앙값: 2.3510
- Bwd Header Size Max 평균: 2.3161, 중앙값: 2.4597
- Flow Pkts Per Sec 평균: 0.3214, 중앙값: 0.1440

### 2. HTTP_Flood 규칙 불일치 (매우 심각)

**가이드 규칙**:
- Resp Pkts > 2.0
- Resp Ip Bytes > 2.5

**실제 데이터**:
- Resp Pkts > 2.0: **0.7%만 만족** ❌❌❌
- Resp Ip Bytes > 2.5: **0.7%만 만족** ❌❌❌

**실제 데이터 통계**:
- Resp Pkts 평균: 0.1756, 중앙값: -0.5003
- Resp Ip Bytes 평균: 0.3070, 중앙값: -0.5368

**문제**: 가이드 규칙이 완전히 잘못되었습니다! 실제 데이터는 대부분 음수이거나 매우 작은 값입니다.

### 3. ICMP_Flood 규칙 불일치

**가이드 규칙**:
- Flow Pkts Per Sec > 0.04

**실제 데이터**:
- Flow Pkts Per Sec > 0.04: **12.0%만 만족** ❌

**실제 데이터 통계**:
- Flow Pkts Per Sec 평균: 0.0143, 중앙값: 0.0008

### 4. BotNet_DDOS 규칙 (상대적으로 양호)

**가이드 규칙**:
- Flow Pkts Per Sec ≈ 0.0
- Negative packet/byte values

**실제 데이터**:
- Flow Pkts Per Sec ≈ 0.0: **100.0% 만족** ✅
- Negative packet values: **100.0% 만족** ✅

## 문제 요약

| 클래스 | 규칙 만족율 | 상태 |
|--------|------------|------|
| Arp_Spoofing | 20.8% (모든 규칙) | ❌ 심각 |
| HTTP_Flood | 0.7% | ❌❌❌ 매우 심각 |
| ICMP_Flood | 12.0% | ❌ 심각 |
| BotNet_DDOS | 100.0% | ✅ 양호 |

## 원인 분석

1. **통계 분석 기반 규칙**: 가이드의 규칙이 통계 분석(평균, 중앙값 등)을 기반으로 만들어졌지만, 실제로는 대부분의 샘플이 규칙을 만족하지 않음

2. **정규화된 데이터**: 데이터가 정규화되어 있어서 원본 값과 다를 수 있음

3. **불균형한 데이터**: 일부 클래스는 특정 패턴만 가지고 있어서 평균 기반 규칙이 부적절함

## 해결 방안

### 1. 실제 데이터 기반 규칙 재생성
- 실제 데이터의 분포를 기반으로 규칙 생성
- 중앙값, 사분위수 등을 활용
- 대부분의 샘플(예: 80% 이상)이 만족하는 규칙 사용

### 2. 더 유연한 규칙
- 단일 규칙 대신 여러 규칙의 조합
- "OR" 조건 사용
- 범위 기반 규칙 (예: "0.1 < value < 0.5")

### 3. 실제 데이터 예시 포함
- 각 클래스의 실제 샘플 값들을 가이드에 포함
- "일반적인 값 범위" 제공

## 다음 단계

1. 실제 데이터 기반으로 규칙 재생성
2. 재생성된 규칙으로 가이드 업데이트
3. 업데이트된 가이드로 테스트

